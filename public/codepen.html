<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CodePen</title>
  <style>
    * {
      box-sizing: border-box;
    }

    :root {
      --page-count: 20;
      --page-scroll: 25;
      --underline: rgba(64, 64, 64, 0.4);
      --spine: #000;
      --cover: #1a1a1a;
      --bg: #4d4d4d;
      --insert: #d9d9d9;
      --page: #e6e6e6;
    }

    body {
      width: 100vw;
      height: calc(((var(--page-count) + 2) * var(--page-scroll)) * 1vh);
      background: var(--bg);
      overflow-x: hidden;
    }

    h1 {
      text-align: center;
      font-size: 1rem;
      margin: 0;
      padding: 0;
    }

    .page {
      height: 100%;
      width: 100%;
      position: relative;
      transform-style: preserve-3d;
    }

    .page .page__number {
      position: absolute;
      color: #808080;
      bottom: 1rem;
      font-size: 1vmin;
    }

    .page__half--front .page__number {
      right: 1rem;
    }

    .page__half--back .page__number {
      left: 1rem;
    }

    .page__half {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100%;
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      transform: rotateY(calc(var(--rotation) * 1deg)) translate3d(0, 0, calc((0.5 * var(--coefficient)) * 1px));
      -webkit-clip-path: inset(0 0.5% 0 0.5%);
      clip-path: inset(0 0.5% 0 0.5%);
    }

    .page__half--front {
      --rotation: 0;
      --coefficient: 0;
      -webkit-backface-visibility: hidden;
      backface-visibility: hidden;
      border-radius: 0 5% 5% 0;
    }

    .page__half--back {
      --rotation: 180;
      --coefficient: 2;
      border-radius: 5% 0 0 5%;
    }

    .book {
      height: 40vmin;
      position: fixed;
      width: 30vmin;
      min-width: 150px;
      min-height: 200px;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0.5);
      transform-style: preserve-3d;
      perspective: 1200px;
    }

    .book__insert {
      content: '';
      position: absolute;
      height: 94%;
      width: 94%;
      background: var(--insert);
      top: 50%;
      right: -1rem;
      transform: translate(0, -50%);
      border-radius: 5% 0 0 5%;
    }

    .book__spine {
      height: 100%;
      left: 0;
      top: 0;
      position: absolute;
      background: var(--spine);
      transform-origin: 0 50%;
      width: 12px;
      transform: translate3d(0, 0, -13px) scaleX(1) rotateY(0deg);
    }

    .book__page {
      position: absolute;
      left: 2%;
      top: 50%;
      border-radius: 0 5% 5% 0;
      transform: translate(0, -50%);
      height: 94%;
      width: 94%;
      z-index: calc(((var(--page-count) + 2) - var(--page-index)) * 2);
      transform-origin: 0% 50%;
    }

    .book__cover {
      border-radius: 0 5% 5% 0;
      height: 100%;
      width: 100%;
      position: absolute;
      top: 50%;
      left: 0;
      background: var(--cover);
    }

    .book__cover--front {
      transform-origin: 0 50%;
    }

    .book__cover--front .page__half--back {
      border-right: 1rem solid var(--spine);
    }

    .book__cover--back {
      transform-origin: 0% 50%;
    }

    .book__cover--back .page__half--front {
      border-left: 1rem solid var(--spine);
    }

    .book__cover--back .book__insert {
      left: 0;
      border-radius: 0 5% 5% 0;
    }

    .book__page:not(.book__cover) .page__half {
      background: repeating-linear-gradient(0deg, transparent 0 1rem, var(--underline) 1rem calc(1rem + 1px), transparent calc(1rem + 1px)) 0 1rem/100% 100% no-repeat, var(--page);
    }

    .code {
      line-height: 1.2;
      font-family: monospace;
      white-space: pre-line;
      max-width: 100%;
      max-height: 100%;
      font-weight: bold;
      color: #0f0f0f;
      text-shadow: 2px 2px 0 #1c1c1c;
      border-radius: 5%;
      display: block;
      overflow: hidden;
    }

    img {
      width: 90%;
      height: 90%;
      -o-object-fit: center;
      object-fit: center;
      z-index: 2;
    }
  </style>
</head>

<body>
  <div id="app">
    <div class="book">
      <div class="book__spine"></div>
      <div class="page book__page book__cover book__cover--front" style="--page-index: 1;">
        <div class="page__half page__half--front"></div>
        <div class="page__half page__half--back"></div>
      </div>
      <div class="page book__page" style="--page-index: 2;">
        <div class="page__half page__half--front"><img
            src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/605876/Tcannon-sketch.svg" />
          <div class="page__number">1</div>
        </div>
        <div class="page__half page__half--back"><img
            src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/605876/Cubes-sketch.svg" />
          <div class="page__number">2</div>
        </div>
      </div>
      <div class="page book__page" style="--page-index: 3;">
        <div class="page__half page__half--front"><img
            src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/605876/Pokedex-sketch.svg" />
          <div class="page__number">3</div>
        </div>
        <div class="page__half page__half--back"><img
            src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/605876/Book-sketch.svg" />
          <div class="page__number">4</div>
        </div>
      </div>
      <div class="page book__page" style="--page-index: 4;">
        <div class="page__half page__half--front"><img
            src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/605876/Cubes-sketch.svg" />
          <div class="page__number">5</div>
        </div>
        <div class="page__half page__half--back"><img
            src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/605876/Pino-sketch.svg" />
          <div class="page__number">6</div>
        </div>
      </div>
      <div class="page book__page" style="--page-index: 5;">
        <div class="page__half page__half--front"><img
            src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/605876/Book-sketch.svg" />
          <div class="page__number">7</div>
        </div>
        <div class="page__half page__half--back"><img
            src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/605876/Pino-sketch.svg" />
          <div class="page__number">8</div>
        </div>
      </div>
      <div class="page book__page" style="--page-index: 6;">
        <div class="page__half page__half--front"><img
            src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/605876/Pino-sketch.svg" />
          <div class="page__number">9</div>
        </div>
        <div class="page__half page__half--back"><img
            src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/605876/Launch-sketch.svg" />
          <div class="page__number">10</div>
        </div>
      </div>
      <div class="page book__page" style="--page-index: 7;">
        <div class="page__half page__half--front"><img
            src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/605876/Launch-sketch.svg" />
          <div class="page__number">11</div>
        </div>
        <div class="page__half page__half--back"><img
            src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/605876/Book-sketch.svg" />
          <div class="page__number">12</div>
        </div>
      </div>
      <div class="page book__page" style="--page-index: 8;">
        <div class="page__half page__half--front"><img
            src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/605876/Pino-sketch.svg" />
          <div class="page__number">13</div>
        </div>
        <div class="page__half page__half--back"><img
            src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/605876/Record-sketch.svg" />
          <div class="page__number">14</div>
        </div>
      </div>
      <div class="page book__page" style="--page-index: 9;">
        <div class="page__half page__half--front"><img
            src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/605876/Pino-sketch.svg" />
          <div class="page__number">15</div>
        </div>
        <div class="page__half page__half--back"><img
            src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/605876/Pokedex-sketch.svg" />
          <div class="page__number">16</div>
        </div>
      </div>
      <div class="page book__page" style="--page-index: 10;">
        <div class="page__half page__half--front"><img
            src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/605876/Pino-sketch.svg" />
          <div class="page__number">17</div>
        </div>
        <div class="page__half page__half--back"><img
            src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/605876/Pino-sketch.svg" />
          <div class="page__number">18</div>
        </div>
      </div>
      <div class="page book__page" style="--page-index: 11;">
        <div class="page__half page__half--front"><img
            src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/605876/Elon-sketch.svg" />
          <div class="page__number">19</div>
        </div>
        <div class="page__half page__half--back"><img
            src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/605876/Gun-sketch.svg" />
          <div class="page__number">20</div>
        </div>
      </div>
      <div class="page book__page book__cover book__cover--back" style="--page-index: 12;">
        <div class="page__half page__half--front"></div>
        <div class="page__half page__half--back"></div>
      </div>
    </div>

  </div>

  <script src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/16327/ScrollTrigger.min.js"></script>
  <script src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/16327/gsap-latest-beta.min.js"></script>
  <script>
    const {
      gsap,
      ScrollTrigger,
      gsap: { to, set } } =
      window;

    gsap.registerPlugin(ScrollTrigger);

    to('.book', {
      scrollTrigger: {
        scrub: 1,
        start: () => 0,
        end: () => window.innerHeight * 0.25
      },

      scale: 1
    });



    const PAGES = [...document.querySelectorAll('.book__page')];
    PAGES.forEach((page, index) => {
      set(page, { z: index === 0 ? 13 : -index * 1 });
      if (index === 11) return false;
      to(page, {
        rotateY: `-=${180 - index / 2}`,
        scrollTrigger: {
          scrub: 1,
          start: () => (index + 1) * (window.innerHeight * 0.25),
          end: () => (index + 2) * (window.innerHeight * 0.25)
        }
      });


      to(page, {
        z: index === 0 ? -13 : index,
        scrollTrigger: {
          scrub: 1,
          start: () => (index + 1) * (window.innerHeight * 0.25),
          end: () => (index + 1.5) * (window.innerHeight * 0.25)
        }
      });


    });
  </script>
</body>

</html>